09-17 17:35:10 jdbc[4]: SQLException
org.h2.jdbc.JdbcSQLException: Deadlock detected. The current transaction was rolled back. Details: "
Session #17 (user: WSO2CARBON) is waiting to lock PUBLIC.COLUMNS_V2 while locking PUBLIC.IDXS (shared), PUBLIC.TBLS (shared), PUBLIC.DBS (shared), PUBLIC.TBL_PRIVS (shared), PUBLIC.TBL_COL_PRIVS (shared), PUBLIC.PART_PRIVS (shared), PUBLIC.PARTITIONS (shared), PUBLIC.PART_COL_PRIVS (shared), PUBLIC.SDS (exclusive).
Session #16 (user: WSO2CARBON) is waiting to lock PUBLIC.SDS while locking PUBLIC.PARTITION_KEYS (shared), PUBLIC.COLUMNS_V2 (shared), PUBLIC.SORT_COLS (shared), PUBLIC.IDXS (shared), PUBLIC.TBLS (shared), PUBLIC.DBS (shared), PUBLIC.TBL_PRIVS (shared), PUBLIC.TBL_COL_PRIVS (shared), PUBLIC.PART_PRIVS (shared), PUBLIC.PARTITIONS (shared), PUBLIC.PART_COL_PRIVS (shared)."; SQL statement:
UPDATE SDS SET CD_ID=? WHERE SD_ID=? [40001-140]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:327)
	at org.h2.message.DbException.get(DbException.java:167)
	at org.h2.message.DbException.get(DbException.java:144)
	at org.h2.table.RegularTable.doLock(RegularTable.java:457)
	at org.h2.table.RegularTable.lock(RegularTable.java:404)
	at org.h2.command.dml.Update.update(Update.java:80)
	at org.h2.command.CommandContainer.update(CommandContainer.java:70)
	at org.h2.command.Command.executeUpdate(Command.java:199)
	at org.h2.jdbc.JdbcPreparedStatement.executeUpdateInternal(JdbcPreparedStatement.java:141)
	at org.h2.jdbc.JdbcPreparedStatement.executeUpdate(JdbcPreparedStatement.java:127)
	at org.apache.commons.dbcp.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:105)
	at org.apache.commons.dbcp.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:105)
	at org.datanucleus.store.rdbms.SQLController.executeStatementUpdate(SQLController.java:419)
	at org.datanucleus.store.rdbms.request.UpdateRequest.execute(UpdateRequest.java:375)
	at org.datanucleus.store.rdbms.RDBMSPersistenceHandler.updateTable(RDBMSPersistenceHandler.java:411)
	at org.datanucleus.store.rdbms.RDBMSPersistenceHandler.updateObject(RDBMSPersistenceHandler.java:384)
	at org.datanucleus.state.JDOStateManager.flush(JDOStateManager.java:3846)
	at org.datanucleus.ObjectManagerImpl.flushInternalWithOrdering(ObjectManagerImpl.java:3888)
	at org.datanucleus.ObjectManagerImpl.flushInternal(ObjectManagerImpl.java:3811)
	at org.datanucleus.MultithreadedObjectManager.flushInternal(MultithreadedObjectManager.java:531)
	at org.datanucleus.store.query.Query.prepareDatastore(Query.java:1560)
	at org.datanucleus.store.query.Query.executeQuery(Query.java:1763)
	at org.datanucleus.store.query.Query.executeWithArray(Query.java:1666)
	at org.datanucleus.api.jdo.JDOQuery.execute(JDOQuery.java:243)
	at org.apache.hadoop.hive.metastore.ObjectStore.listStorageDescriptorsWithCD(ObjectStore.java:2063)
	at org.apache.hadoop.hive.metastore.ObjectStore.removeUnusedColumnDescriptor(ObjectStore.java:2009)
	at org.apache.hadoop.hive.metastore.ObjectStore.preDropStorageDescriptor(ObjectStore.java:2040)
	at org.apache.hadoop.hive.metastore.ObjectStore.dropTable(ObjectStore.java:739)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_table_core(HiveMetaStore.java:1154)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.access$800(HiveMetaStore.java:141)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler$16.run(HiveMetaStore.java:1180)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler$16.run(HiveMetaStore.java:1177)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.executeWithRetry(HiveMetaStore.java:360)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_table(HiveMetaStore.java:1177)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropTable(HiveMetaStoreClient.java:552)
	at org.apache.hadoop.hive.ql.metadata.Hive.dropTable(Hive.java:820)
	at org.apache.hadoop.hive.ql.metadata.Hive.dropTable(Hive.java:783)
	at org.apache.hadoop.hive.ql.exec.DDLTask.dropTable(DDLTask.java:3171)
	at org.apache.hadoop.hive.ql.exec.DDLTask.execute(DDLTask.java:250)
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:129)
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:62)
	at org.apache.hadoop.hive.ql.Driver.launchTask(Driver.java:1351)
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:1126)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:934)
	at org.apache.hadoop.hive.service.HiveServer$HiveServerHandler.execute(HiveServer.java:201)
	at org.apache.hadoop.hive.jdbc.HiveStatement.executeQuery(HiveStatement.java:187)
	at org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl$ScriptCallable.executeHiveQuery(HiveExecutorServiceImpl.java:569)
	at org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl$ScriptCallable.call(HiveExecutorServiceImpl.java:282)
	at org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl$ScriptCallable.call(HiveExecutorServiceImpl.java:189)
	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
	at java.util.concurrent.FutureTask.run(FutureTask.java:138)
	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:895)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:918)
	at java.lang.Thread.run(Thread.java:662)
09-17 17:35:10 jdbc[3]: SQLException
org.h2.jdbc.JdbcSQLException: Deadlock detected. The current transaction was rolled back. Details: "
Session #17 (user: WSO2CARBON) is waiting to lock PUBLIC.TBLS while locking PUBLIC.IDXS (shared), PUBLIC.TBLS (shared), PUBLIC.DBS (shared), PUBLIC.TBL_PRIVS (shared), PUBLIC.TBL_COL_PRIVS (shared), PUBLIC.PART_PRIVS (shared), PUBLIC.PARTITIONS (shared), PUBLIC.PART_COL_PRIVS (shared), PUBLIC.SDS (exclusive), PUBLIC.COLUMNS_V2 (exclusive), PUBLIC.CDS (exclusive), PUBLIC.TABLE_PARAMS (exclusive).
Session #15 (user: WSO2CARBON) is waiting to lock PUBLIC.SDS while locking PUBLIC.SORT_COLS (shared), PUBLIC.IDXS (shared), PUBLIC.TBLS (shared), PUBLIC.DBS (shared), PUBLIC.TBL_PRIVS (shared), PUBLIC.TBL_COL_PRIVS (shared), PUBLIC.PART_PRIVS (shared), PUBLIC.PARTITIONS (shared), PUBLIC.PART_COL_PRIVS (shared)."; SQL statement:
UPDATE SDS SET CD_ID=? WHERE SD_ID=? [40001-140]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:327)
	at org.h2.message.DbException.get(DbException.java:167)
	at org.h2.message.DbException.get(DbException.java:144)
	at org.h2.table.RegularTable.doLock(RegularTable.java:457)
	at org.h2.table.RegularTable.lock(RegularTable.java:404)
	at org.h2.command.dml.Update.update(Update.java:80)
	at org.h2.command.CommandContainer.update(CommandContainer.java:70)
	at org.h2.command.Command.executeUpdate(Command.java:199)
	at org.h2.jdbc.JdbcPreparedStatement.executeUpdateInternal(JdbcPreparedStatement.java:141)
	at org.h2.jdbc.JdbcPreparedStatement.executeUpdate(JdbcPreparedStatement.java:127)
	at org.apache.commons.dbcp.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:105)
	at org.apache.commons.dbcp.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:105)
	at org.datanucleus.store.rdbms.SQLController.executeStatementUpdate(SQLController.java:419)
	at org.datanucleus.store.rdbms.request.UpdateRequest.execute(UpdateRequest.java:375)
	at org.datanucleus.store.rdbms.RDBMSPersistenceHandler.updateTable(RDBMSPersistenceHandler.java:411)
	at org.datanucleus.store.rdbms.RDBMSPersistenceHandler.updateObject(RDBMSPersistenceHandler.java:384)
	at org.datanucleus.state.JDOStateManager.flush(JDOStateManager.java:3846)
	at org.datanucleus.ObjectManagerImpl.flushInternalWithOrdering(ObjectManagerImpl.java:3888)
	at org.datanucleus.ObjectManagerImpl.flushInternal(ObjectManagerImpl.java:3811)
	at org.datanucleus.MultithreadedObjectManager.flushInternal(MultithreadedObjectManager.java:531)
	at org.datanucleus.store.query.Query.prepareDatastore(Query.java:1560)
	at org.datanucleus.store.query.Query.executeQuery(Query.java:1763)
	at org.datanucleus.store.query.Query.executeWithArray(Query.java:1666)
	at org.datanucleus.api.jdo.JDOQuery.execute(JDOQuery.java:243)
	at org.apache.hadoop.hive.metastore.ObjectStore.listStorageDescriptorsWithCD(ObjectStore.java:2063)
	at org.apache.hadoop.hive.metastore.ObjectStore.removeUnusedColumnDescriptor(ObjectStore.java:2009)
	at org.apache.hadoop.hive.metastore.ObjectStore.preDropStorageDescriptor(ObjectStore.java:2040)
	at org.apache.hadoop.hive.metastore.ObjectStore.dropTable(ObjectStore.java:739)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_table_core(HiveMetaStore.java:1154)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.access$800(HiveMetaStore.java:141)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler$16.run(HiveMetaStore.java:1180)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler$16.run(HiveMetaStore.java:1177)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.executeWithRetry(HiveMetaStore.java:360)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_table(HiveMetaStore.java:1177)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropTable(HiveMetaStoreClient.java:552)
	at org.apache.hadoop.hive.ql.metadata.Hive.dropTable(Hive.java:820)
	at org.apache.hadoop.hive.ql.metadata.Hive.dropTable(Hive.java:783)
	at org.apache.hadoop.hive.ql.exec.DDLTask.dropTable(DDLTask.java:3171)
	at org.apache.hadoop.hive.ql.exec.DDLTask.execute(DDLTask.java:250)
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:129)
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:62)
	at org.apache.hadoop.hive.ql.Driver.launchTask(Driver.java:1351)
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:1126)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:934)
	at org.apache.hadoop.hive.service.HiveServer$HiveServerHandler.execute(HiveServer.java:201)
	at org.apache.hadoop.hive.jdbc.HiveStatement.executeQuery(HiveStatement.java:187)
	at org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl$ScriptCallable.executeHiveQuery(HiveExecutorServiceImpl.java:569)
	at org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl$ScriptCallable.call(HiveExecutorServiceImpl.java:282)
	at org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl$ScriptCallable.call(HiveExecutorServiceImpl.java:189)
	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
	at java.util.concurrent.FutureTask.run(FutureTask.java:138)
	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:895)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:918)
	at java.lang.Thread.run(Thread.java:662)
09-19 14:15:11 jdbc[4]: SQLException
org.h2.jdbc.JdbcSQLException: Deadlock detected. The current transaction was rolled back. Details: "
Session #15 (user: WSO2CARBON) is waiting to lock PUBLIC.COLUMNS_V2 while locking PUBLIC.IDXS (shared), PUBLIC.TBLS (shared), PUBLIC.DBS (shared), PUBLIC.TBL_PRIVS (shared), PUBLIC.TBL_COL_PRIVS (shared), PUBLIC.PART_PRIVS (shared), PUBLIC.PARTITIONS (shared), PUBLIC.PART_COL_PRIVS (shared), PUBLIC.SDS (exclusive).
Session #16 (user: WSO2CARBON) is waiting to lock PUBLIC.SDS while locking PUBLIC.COLUMNS_V2 (shared), PUBLIC.SORT_COLS (shared), PUBLIC.IDXS (shared), PUBLIC.TBLS (shared), PUBLIC.DBS (shared), PUBLIC.TBL_PRIVS (shared), PUBLIC.TBL_COL_PRIVS (shared), PUBLIC.PART_PRIVS (shared), PUBLIC.PARTITIONS (shared), PUBLIC.PART_COL_PRIVS (shared)."; SQL statement:
UPDATE SDS SET CD_ID=? WHERE SD_ID=? [40001-140]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:327)
	at org.h2.message.DbException.get(DbException.java:167)
	at org.h2.message.DbException.get(DbException.java:144)
	at org.h2.table.RegularTable.doLock(RegularTable.java:457)
	at org.h2.table.RegularTable.lock(RegularTable.java:404)
	at org.h2.command.dml.Update.update(Update.java:80)
	at org.h2.command.CommandContainer.update(CommandContainer.java:70)
	at org.h2.command.Command.executeUpdate(Command.java:199)
	at org.h2.jdbc.JdbcPreparedStatement.executeUpdateInternal(JdbcPreparedStatement.java:141)
	at org.h2.jdbc.JdbcPreparedStatement.executeUpdate(JdbcPreparedStatement.java:127)
	at org.apache.commons.dbcp.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:105)
	at org.apache.commons.dbcp.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:105)
	at org.datanucleus.store.rdbms.SQLController.executeStatementUpdate(SQLController.java:419)
	at org.datanucleus.store.rdbms.request.UpdateRequest.execute(UpdateRequest.java:375)
	at org.datanucleus.store.rdbms.RDBMSPersistenceHandler.updateTable(RDBMSPersistenceHandler.java:411)
	at org.datanucleus.store.rdbms.RDBMSPersistenceHandler.updateObject(RDBMSPersistenceHandler.java:384)
	at org.datanucleus.state.JDOStateManager.flush(JDOStateManager.java:3846)
	at org.datanucleus.ObjectManagerImpl.flushInternalWithOrdering(ObjectManagerImpl.java:3888)
	at org.datanucleus.ObjectManagerImpl.flushInternal(ObjectManagerImpl.java:3811)
	at org.datanucleus.MultithreadedObjectManager.flushInternal(MultithreadedObjectManager.java:531)
	at org.datanucleus.store.query.Query.prepareDatastore(Query.java:1560)
	at org.datanucleus.store.query.Query.executeQuery(Query.java:1763)
	at org.datanucleus.store.query.Query.executeWithArray(Query.java:1666)
	at org.datanucleus.api.jdo.JDOQuery.execute(JDOQuery.java:243)
	at org.apache.hadoop.hive.metastore.ObjectStore.listStorageDescriptorsWithCD(ObjectStore.java:2063)
	at org.apache.hadoop.hive.metastore.ObjectStore.removeUnusedColumnDescriptor(ObjectStore.java:2009)
	at org.apache.hadoop.hive.metastore.ObjectStore.preDropStorageDescriptor(ObjectStore.java:2040)
	at org.apache.hadoop.hive.metastore.ObjectStore.dropTable(ObjectStore.java:739)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_table_core(HiveMetaStore.java:1154)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.access$800(HiveMetaStore.java:141)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler$16.run(HiveMetaStore.java:1180)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler$16.run(HiveMetaStore.java:1177)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.executeWithRetry(HiveMetaStore.java:360)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_table(HiveMetaStore.java:1177)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropTable(HiveMetaStoreClient.java:552)
	at org.apache.hadoop.hive.ql.metadata.Hive.dropTable(Hive.java:820)
	at org.apache.hadoop.hive.ql.metadata.Hive.dropTable(Hive.java:783)
	at org.apache.hadoop.hive.ql.exec.DDLTask.dropTable(DDLTask.java:3171)
	at org.apache.hadoop.hive.ql.exec.DDLTask.execute(DDLTask.java:250)
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:129)
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:62)
	at org.apache.hadoop.hive.ql.Driver.launchTask(Driver.java:1351)
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:1126)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:934)
	at org.apache.hadoop.hive.service.HiveServer$HiveServerHandler.execute(HiveServer.java:201)
	at org.apache.hadoop.hive.jdbc.HiveStatement.executeQuery(HiveStatement.java:187)
	at org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl$ScriptCallable.executeHiveQuery(HiveExecutorServiceImpl.java:569)
	at org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl$ScriptCallable.call(HiveExecutorServiceImpl.java:282)
	at org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl$ScriptCallable.call(HiveExecutorServiceImpl.java:189)
	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
	at java.util.concurrent.FutureTask.run(FutureTask.java:138)
	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:895)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:918)
	at java.lang.Thread.run(Thread.java:662)
09-19 14:15:11 jdbc[5]: SQLException
org.h2.jdbc.JdbcSQLException: Deadlock detected. The current transaction was rolled back. Details: "
Session #15 (user: WSO2CARBON) is waiting to lock PUBLIC.TBLS while locking PUBLIC.IDXS (shared), PUBLIC.TBLS (shared), PUBLIC.DBS (shared), PUBLIC.TBL_PRIVS (shared), PUBLIC.TBL_COL_PRIVS (shared), PUBLIC.PART_PRIVS (shared), PUBLIC.PARTITIONS (shared), PUBLIC.PART_COL_PRIVS (shared), PUBLIC.SDS (exclusive), PUBLIC.COLUMNS_V2 (exclusive), PUBLIC.CDS (exclusive), PUBLIC.TABLE_PARAMS (exclusive).
Session #17 (user: WSO2CARBON) is waiting to lock PUBLIC.SDS while locking PUBLIC.SORT_COLS (shared), PUBLIC.IDXS (shared), PUBLIC.TBLS (shared), PUBLIC.DBS (shared), PUBLIC.TBL_PRIVS (shared), PUBLIC.TBL_COL_PRIVS (shared), PUBLIC.PART_PRIVS (shared), PUBLIC.PARTITIONS (shared), PUBLIC.PART_COL_PRIVS (shared)."; SQL statement:
UPDATE SDS SET CD_ID=? WHERE SD_ID=? [40001-140]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:327)
	at org.h2.message.DbException.get(DbException.java:167)
	at org.h2.message.DbException.get(DbException.java:144)
	at org.h2.table.RegularTable.doLock(RegularTable.java:457)
	at org.h2.table.RegularTable.lock(RegularTable.java:404)
	at org.h2.command.dml.Update.update(Update.java:80)
	at org.h2.command.CommandContainer.update(CommandContainer.java:70)
	at org.h2.command.Command.executeUpdate(Command.java:199)
	at org.h2.jdbc.JdbcPreparedStatement.executeUpdateInternal(JdbcPreparedStatement.java:141)
	at org.h2.jdbc.JdbcPreparedStatement.executeUpdate(JdbcPreparedStatement.java:127)
	at org.apache.commons.dbcp.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:105)
	at org.apache.commons.dbcp.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:105)
	at org.datanucleus.store.rdbms.SQLController.executeStatementUpdate(SQLController.java:419)
	at org.datanucleus.store.rdbms.request.UpdateRequest.execute(UpdateRequest.java:375)
	at org.datanucleus.store.rdbms.RDBMSPersistenceHandler.updateTable(RDBMSPersistenceHandler.java:411)
	at org.datanucleus.store.rdbms.RDBMSPersistenceHandler.updateObject(RDBMSPersistenceHandler.java:384)
	at org.datanucleus.state.JDOStateManager.flush(JDOStateManager.java:3846)
	at org.datanucleus.ObjectManagerImpl.flushInternalWithOrdering(ObjectManagerImpl.java:3888)
	at org.datanucleus.ObjectManagerImpl.flushInternal(ObjectManagerImpl.java:3811)
	at org.datanucleus.MultithreadedObjectManager.flushInternal(MultithreadedObjectManager.java:531)
	at org.datanucleus.store.query.Query.prepareDatastore(Query.java:1560)
	at org.datanucleus.store.query.Query.executeQuery(Query.java:1763)
	at org.datanucleus.store.query.Query.executeWithArray(Query.java:1666)
	at org.datanucleus.api.jdo.JDOQuery.execute(JDOQuery.java:243)
	at org.apache.hadoop.hive.metastore.ObjectStore.listStorageDescriptorsWithCD(ObjectStore.java:2063)
	at org.apache.hadoop.hive.metastore.ObjectStore.removeUnusedColumnDescriptor(ObjectStore.java:2009)
	at org.apache.hadoop.hive.metastore.ObjectStore.preDropStorageDescriptor(ObjectStore.java:2040)
	at org.apache.hadoop.hive.metastore.ObjectStore.dropTable(ObjectStore.java:739)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_table_core(HiveMetaStore.java:1154)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.access$800(HiveMetaStore.java:141)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler$16.run(HiveMetaStore.java:1180)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler$16.run(HiveMetaStore.java:1177)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.executeWithRetry(HiveMetaStore.java:360)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_table(HiveMetaStore.java:1177)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropTable(HiveMetaStoreClient.java:552)
	at org.apache.hadoop.hive.ql.metadata.Hive.dropTable(Hive.java:820)
	at org.apache.hadoop.hive.ql.metadata.Hive.dropTable(Hive.java:783)
	at org.apache.hadoop.hive.ql.exec.DDLTask.dropTable(DDLTask.java:3171)
	at org.apache.hadoop.hive.ql.exec.DDLTask.execute(DDLTask.java:250)
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:129)
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:62)
	at org.apache.hadoop.hive.ql.Driver.launchTask(Driver.java:1351)
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:1126)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:934)
	at org.apache.hadoop.hive.service.HiveServer$HiveServerHandler.execute(HiveServer.java:201)
	at org.apache.hadoop.hive.jdbc.HiveStatement.executeQuery(HiveStatement.java:187)
	at org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl$ScriptCallable.executeHiveQuery(HiveExecutorServiceImpl.java:569)
	at org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl$ScriptCallable.call(HiveExecutorServiceImpl.java:282)
	at org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl$ScriptCallable.call(HiveExecutorServiceImpl.java:189)
	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
	at java.util.concurrent.FutureTask.run(FutureTask.java:138)
	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:895)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:918)
	at java.lang.Thread.run(Thread.java:662)
09-22 09:31:11 jdbc[4]: SQLException
org.h2.jdbc.JdbcSQLException: Deadlock detected. The current transaction was rolled back. Details: "
Session #13 (user: WSO2CARBON) is waiting to lock PUBLIC.TBLS while locking PUBLIC.IDXS (shared), PUBLIC.TBLS (shared), PUBLIC.DBS (shared), PUBLIC.TBL_PRIVS (shared), PUBLIC.TBL_COL_PRIVS (shared), PUBLIC.PART_PRIVS (shared), PUBLIC.PARTITIONS (shared), PUBLIC.PART_COL_PRIVS (shared), PUBLIC.SDS (exclusive), PUBLIC.COLUMNS_V2 (exclusive), PUBLIC.CDS (exclusive), PUBLIC.PARTITION_KEYS (exclusive).
Session #16 (user: WSO2CARBON) is waiting to lock PUBLIC.SDS while locking PUBLIC.IDXS (shared), PUBLIC.TBLS (shared), PUBLIC.DBS (shared), PUBLIC.TBL_PRIVS (shared), PUBLIC.TBL_COL_PRIVS (shared), PUBLIC.PART_PRIVS (shared), PUBLIC.PARTITIONS (shared), PUBLIC.PART_COL_PRIVS (shared)."; SQL statement:
UPDATE SDS SET CD_ID=? WHERE SD_ID=? [40001-140]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:327)
	at org.h2.message.DbException.get(DbException.java:167)
	at org.h2.message.DbException.get(DbException.java:144)
	at org.h2.table.RegularTable.doLock(RegularTable.java:457)
	at org.h2.table.RegularTable.lock(RegularTable.java:404)
	at org.h2.command.dml.Update.update(Update.java:80)
	at org.h2.command.CommandContainer.update(CommandContainer.java:70)
	at org.h2.command.Command.executeUpdate(Command.java:199)
	at org.h2.jdbc.JdbcPreparedStatement.executeUpdateInternal(JdbcPreparedStatement.java:141)
	at org.h2.jdbc.JdbcPreparedStatement.executeUpdate(JdbcPreparedStatement.java:127)
	at org.apache.commons.dbcp.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:105)
	at org.apache.commons.dbcp.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:105)
	at org.datanucleus.store.rdbms.SQLController.executeStatementUpdate(SQLController.java:419)
	at org.datanucleus.store.rdbms.request.UpdateRequest.execute(UpdateRequest.java:375)
	at org.datanucleus.store.rdbms.RDBMSPersistenceHandler.updateTable(RDBMSPersistenceHandler.java:411)
	at org.datanucleus.store.rdbms.RDBMSPersistenceHandler.updateObject(RDBMSPersistenceHandler.java:384)
	at org.datanucleus.state.JDOStateManager.flush(JDOStateManager.java:3846)
	at org.datanucleus.ObjectManagerImpl.flushInternalWithOrdering(ObjectManagerImpl.java:3888)
	at org.datanucleus.ObjectManagerImpl.flushInternal(ObjectManagerImpl.java:3811)
	at org.datanucleus.MultithreadedObjectManager.flushInternal(MultithreadedObjectManager.java:531)
	at org.datanucleus.store.query.Query.prepareDatastore(Query.java:1560)
	at org.datanucleus.store.query.Query.executeQuery(Query.java:1763)
	at org.datanucleus.store.query.Query.executeWithArray(Query.java:1666)
	at org.datanucleus.api.jdo.JDOQuery.execute(JDOQuery.java:243)
	at org.apache.hadoop.hive.metastore.ObjectStore.listStorageDescriptorsWithCD(ObjectStore.java:2063)
	at org.apache.hadoop.hive.metastore.ObjectStore.removeUnusedColumnDescriptor(ObjectStore.java:2009)
	at org.apache.hadoop.hive.metastore.ObjectStore.preDropStorageDescriptor(ObjectStore.java:2040)
	at org.apache.hadoop.hive.metastore.ObjectStore.dropTable(ObjectStore.java:739)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_table_core(HiveMetaStore.java:1154)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.access$800(HiveMetaStore.java:141)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler$16.run(HiveMetaStore.java:1180)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler$16.run(HiveMetaStore.java:1177)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.executeWithRetry(HiveMetaStore.java:360)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_table(HiveMetaStore.java:1177)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropTable(HiveMetaStoreClient.java:552)
	at org.apache.hadoop.hive.ql.metadata.Hive.dropTable(Hive.java:820)
	at org.apache.hadoop.hive.ql.metadata.Hive.dropTable(Hive.java:783)
	at org.apache.hadoop.hive.ql.exec.DDLTask.dropTable(DDLTask.java:3171)
	at org.apache.hadoop.hive.ql.exec.DDLTask.execute(DDLTask.java:250)
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:129)
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:62)
	at org.apache.hadoop.hive.ql.Driver.launchTask(Driver.java:1351)
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:1126)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:934)
	at org.apache.hadoop.hive.service.HiveServer$HiveServerHandler.execute(HiveServer.java:201)
	at org.apache.hadoop.hive.jdbc.HiveStatement.executeQuery(HiveStatement.java:187)
	at org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl$ScriptCallable.executeHiveQuery(HiveExecutorServiceImpl.java:569)
	at org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl$ScriptCallable.call(HiveExecutorServiceImpl.java:282)
	at org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl$ScriptCallable.call(HiveExecutorServiceImpl.java:189)
	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
	at java.util.concurrent.FutureTask.run(FutureTask.java:138)
	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:895)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:918)
	at java.lang.Thread.run(Thread.java:662)
09-22 09:31:11 jdbc[3]: SQLException
org.h2.jdbc.JdbcSQLException: Deadlock detected. The current transaction was rolled back. Details: "
Session #17 (user: WSO2CARBON) is waiting to lock PUBLIC.SDS while locking PUBLIC.IDXS (shared), PUBLIC.TBLS (shared), PUBLIC.DBS (shared), PUBLIC.TBL_PRIVS (shared), PUBLIC.TBL_COL_PRIVS (shared), PUBLIC.PART_PRIVS (shared), PUBLIC.PARTITIONS (shared), PUBLIC.PART_COL_PRIVS (shared).
Session #13 (user: WSO2CARBON) is waiting to lock PUBLIC.TBLS while locking PUBLIC.IDXS (shared), PUBLIC.TBLS (shared), PUBLIC.DBS (shared), PUBLIC.TBL_PRIVS (shared), PUBLIC.TBL_COL_PRIVS (shared), PUBLIC.PART_PRIVS (shared), PUBLIC.PARTITIONS (shared), PUBLIC.PART_COL_PRIVS (shared), PUBLIC.SDS (exclusive), PUBLIC.COLUMNS_V2 (exclusive), PUBLIC.CDS (exclusive), PUBLIC.PARTITION_KEYS (exclusive)."; SQL statement:
UPDATE TBLS SET SD_ID=? WHERE TBL_ID=? [40001-140]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:327)
	at org.h2.message.DbException.get(DbException.java:167)
	at org.h2.message.DbException.get(DbException.java:144)
	at org.h2.table.RegularTable.doLock(RegularTable.java:457)
	at org.h2.table.RegularTable.lock(RegularTable.java:404)
	at org.h2.command.dml.Update.update(Update.java:80)
	at org.h2.command.CommandContainer.update(CommandContainer.java:70)
	at org.h2.command.Command.executeUpdate(Command.java:199)
	at org.h2.jdbc.JdbcPreparedStatement.executeUpdateInternal(JdbcPreparedStatement.java:141)
	at org.h2.jdbc.JdbcPreparedStatement.executeUpdate(JdbcPreparedStatement.java:127)
	at org.apache.commons.dbcp.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:105)
	at org.apache.commons.dbcp.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:105)
	at org.datanucleus.store.rdbms.SQLController.executeStatementUpdate(SQLController.java:419)
	at org.datanucleus.store.rdbms.request.UpdateRequest.execute(UpdateRequest.java:375)
	at org.datanucleus.store.rdbms.RDBMSPersistenceHandler.updateTable(RDBMSPersistenceHandler.java:411)
	at org.datanucleus.store.rdbms.RDBMSPersistenceHandler.updateObject(RDBMSPersistenceHandler.java:384)
	at org.datanucleus.store.mapped.mapping.PersistableMapping.preDelete(PersistableMapping.java:962)
	at org.datanucleus.store.rdbms.request.DeleteRequest.execute(DeleteRequest.java:194)
	at org.datanucleus.store.rdbms.RDBMSPersistenceHandler.deleteTable(RDBMSPersistenceHandler.java:502)
	at org.datanucleus.store.rdbms.RDBMSPersistenceHandler.deleteObject(RDBMSPersistenceHandler.java:473)
	at org.datanucleus.state.JDOStateManager.internalDeletePersistent(JDOStateManager.java:3437)
	at org.datanucleus.state.JDOStateManager.deletePersistent(JDOStateManager.java:3396)
	at org.datanucleus.ObjectManagerImpl.deleteObjectInternal(ObjectManagerImpl.java:2214)
	at org.datanucleus.ObjectManagerImpl.deleteObjectWork(ObjectManagerImpl.java:2136)
	at org.datanucleus.ObjectManagerImpl.deleteObjects(ObjectManagerImpl.java:2023)
	at org.datanucleus.MultithreadedObjectManager.deleteObjects(MultithreadedObjectManager.java:333)
	at org.datanucleus.api.jdo.JDOPersistenceManager.deletePersistentAll(JDOPersistenceManager.java:850)
	at org.datanucleus.api.jdo.JDOPersistenceManager.deletePersistentAll(JDOPersistenceManager.java:834)
	at org.apache.hadoop.hive.metastore.ObjectStore.dropTable(ObjectStore.java:741)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_table_core(HiveMetaStore.java:1154)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.access$800(HiveMetaStore.java:141)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler$16.run(HiveMetaStore.java:1180)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler$16.run(HiveMetaStore.java:1177)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.executeWithRetry(HiveMetaStore.java:360)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_table(HiveMetaStore.java:1177)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropTable(HiveMetaStoreClient.java:552)
	at org.apache.hadoop.hive.ql.metadata.Hive.dropTable(Hive.java:820)
	at org.apache.hadoop.hive.ql.metadata.Hive.dropTable(Hive.java:783)
	at org.apache.hadoop.hive.ql.exec.DDLTask.dropTable(DDLTask.java:3171)
	at org.apache.hadoop.hive.ql.exec.DDLTask.execute(DDLTask.java:250)
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:129)
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:62)
	at org.apache.hadoop.hive.ql.Driver.launchTask(Driver.java:1351)
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:1126)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:934)
	at org.apache.hadoop.hive.service.HiveServer$HiveServerHandler.execute(HiveServer.java:201)
	at org.apache.hadoop.hive.jdbc.HiveStatement.executeQuery(HiveStatement.java:187)
	at org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl$ScriptCallable.executeHiveQuery(HiveExecutorServiceImpl.java:569)
	at org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl$ScriptCallable.call(HiveExecutorServiceImpl.java:282)
	at org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl$ScriptCallable.call(HiveExecutorServiceImpl.java:189)
	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
	at java.util.concurrent.FutureTask.run(FutureTask.java:138)
	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:895)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:918)
	at java.lang.Thread.run(Thread.java:662)
